# Hearts of Iron 4 Mod Development Instructions

This repository contains "バカ世界地図テスト版" (Foolish World Map Test Version), a Hearts of Iron 4 mod based on the "Foolish World Map Project" from Chakuwiki. This mod creates an alternative history scenario with modified maps, countries, and gameplay mechanics.

## Project Context and "Foolish World Map" Concept

This mod is based on the "バカ世界地図" (Foolish World Map) project from Chakuwiki, which presents an alternative world with:

### Key Characteristics
- **Alternative Geography**: Modified world map with fictional or relocated countries
- **Satirical Elements**: Some content includes humorous or absurd scenarios
- **Community-Driven**: Content developed through community collaboration
- **Japanese Origins**: Primary development and community in Japanese

### Unique Countries and Tags
The mod includes both historical and fictional countries. Notable examples from the focus files:
- `WES` - Western Sahara related content
- `NSI` - Custom nation
- `McDonald's.txt` - Corporate-themed alternative history scenarios
- `NOKIA.txt` - Technology/corporate focused content
- Various custom country tags not found in base HOI4

### Content Guidelines for "Foolish World Map"
- Maintain the balance between historical plausibility and creative absurdity
- Respect the satirical nature while ensuring playability
- Consider cultural context and sensitivity, especially for Japanese audiences
- Preserve the community-driven collaborative spirit
- Keep focus trees engaging and mechanically sound despite unusual premises

The main mod files are located in the `bakasekai/` directory, following standard HOI4 modding conventions:

- `common/` - Game mechanics, focuses, ideas, characters, scripted effects
- `events/` - Event files for dynamic gameplay
- `history/` - Initial game state (countries, states, units)
- `localisation/` - Text translations (Japanese and English)
- `gfx/` - Graphics, portraits, icons
- `map/` - Map data and strategic regions
- `interface/` - UI modifications
- `descriptor.mod` - Mod metadata and dependencies

## Coding Standards & Best Practices

### File Naming and Organization
- Use descriptive names that match the content (e.g., `CAN_national_focus.txt` for Canada focuses)
- Group related content in appropriately named files
- Follow HOI4's standard file structure and naming conventions
- Use country tags (CAN, USA, GBR, etc.) as prefixes for country-specific content

### Scripting Syntax
- Use proper indentation (tabs, consistent spacing)
- Always close brackets `{}` properly
- Use meaningful variable and focus names
- Comment complex logic when necessary
- Follow HOI4's scripting language conventions

### National Focus Trees
```paradox
focus = {
    id = COUNTRY_focus_name
    icon = GFX_goal_icon_name
    prerequisite = { focus = COUNTRY_prerequisite_focus }
    x = 0
    y = 1
    cost = 10
    
    completion_reward = {
        # Effects go here
    }
}
```

### Ideas and Modifiers
- Use clear, descriptive names for ideas
- Include proper allowed/available conditions
- Set appropriate AI weights
- Include both picture and modifier effects

### Equipment and Templates
- Create realistic equipment variants
- Use proper module configurations
- Include appropriate icons and names
- Balance stats appropriately

## Localization Guidelines

This mod currently supports Japanese with English translation work in progress:

### Current State
- Primary language: Japanese (located in `bakasekai/localisation/japanese/`)
- English translations: In development via [Paratranz](https://paratranz.cn/projects/9454)
- All localization files use `.yml` format with UTF-8 BOM encoding

### Key Requirements
- All user-facing text must be localized
- Use descriptive localization keys: `COUNTRY_focus_name:0 "Focus Display Name"`
- Japanese translations are mandatory for new content
- English translations should be added when available
- Use British English conventions for English translations
- Maintain consistent terminology across languages

### Localization File Format
```yml
l_japanese:
 focus_name:0 "日本語テキスト"
 focus_name_desc:0 "日本語の説明"
```

### File Organization
- Main mod localizations: `bakasekai/localisation/japanese/bakasekai/`
- Replacement localizations: `bakasekai/localisation/japanese/replace/`
- Country-specific localizations: Use country prefixes (e.g., `JPN_l_japanese.yml`)
- Feature-specific localizations: Group by functionality (e.g., `focus_l_japanese.yml`)

## Country-Specific Guidelines

### When Adding New Countries
- Create country files in `common/country_tags/`
- Add history files in `history/countries/`
- Include proper flag graphics
- Set up basic ideas and national spirits
- Consider diplomatic relationships

### When Modifying Existing Countries
- Maintain historical authenticity where possible
- Balance gameplay considerations
- Update related diplomatic, economic, and military aspects
- Test interactions with other countries

## Equipment and Military Guidelines

### Aircraft Design
- Use realistic naming conventions
- Balance performance stats appropriately
- Include proper upgrade paths
- Consider historical context and progression

### Naval Equipment
- Follow realistic ship classifications
- Balance armor, speed, and firepower
- Include appropriate modules and upgrades
- Consider naval doctrines and strategies

### Land Equipment
- Maintain realistic equipment progression
- Balance cost, performance, and availability
- Consider production and resource requirements
- Include appropriate variants

## Testing and Quality Assurance

### Before Committing Changes
- Test in-game to ensure functionality works
- Check for syntax errors and typos
- Verify localizations load correctly
- Test with AI and player interactions
- Ensure compatibility with existing content

### Performance Considerations
- Optimize scripted effects for performance
- Avoid excessive nested conditions
- Use efficient trigger conditions
- Consider memory usage for large changes

## Common Patterns and Examples

### Focus Tree Structure
Refer to existing focus files like `bakasekai/common/national_focus/generic.txt` for examples of:
- Proper focus prerequisites and positioning
- Completion rewards and tooltips  
- AI behavior configuration
- Search filters implementation

Example focus structure:
```paradox
focus = {
    id = country_focus_name
    icon = GFX_goal_icon_name
    prerequisite = { focus = prerequisite_focus }
    x = 0
    y = 1
    cost = 10
    
    search_filters = {
        FOCUS_FILTER_RESEARCH
    }
    
    available_if_capitulated = yes
    
    completion_reward = {
        army_experience = 100
        add_tech_bonus = {
            name = land_doc_bonus
            bonus = 0.5
            uses = 1
            category = land_doctrine
        }
    }
}
```

### Scripted Effects
Reference `bakasekai/common/scripted_effects/ITA_scripted_effects.txt` for:
- Equipment template creation
- Idea swapping mechanisms
- Dynamic modifier applications
- Country-specific effect patterns

### Ideas and National Spirits
Check files in `bakasekai/common/ideas/` for:
- Proper idea structure and effects
- AI will_do conditions
- Available and visible triggers
- Manufacturer and designer patterns

### Character Definitions
Look at `bakasekai/common/characters/` files for:
- Character database structure
- Portrait assignments
- Role definitions
- Historical character patterns

## Development Environment Setup

### Supported IDEs
- **Visual Studio Code** (recommended)
- **JetBrains IDEs** (IntelliJ IDEA, etc.)

### Recommended VS Code Extensions
- Paradox Modding Tools (if available)
- YAML Language Support
- GitLens for version control
- File and folder icon themes for better organization

### File Encoding
- Use **UTF-8 with BOM** for localization files (.yml)
- Use **UTF-8** for all other text files (.txt)
- Ensure consistent line endings (LF recommended)

## Version Control Best Practices

- Make atomic commits focused on single features
- Use descriptive commit messages
- Test changes before committing
- Include both code and localization changes together
- Document any breaking changes or dependencies

## Community and Collaboration

This mod has an active community on Discord. When contributing:
- Follow established conventions from existing files
- Consider impact on ongoing translation efforts
- Maintain compatibility with the base "Foolish World Map" concept
- Respect the bilingual nature of the project

## Troubleshooting Common Issues

### Localization Problems
- **Missing text**: Ensure localization keys match exactly between script files and .yml files
- **Encoding issues**: Use UTF-8 with BOM for .yml files, UTF-8 for .txt files
- **Invisible characters**: Check for hidden Unicode characters in localization keys

### Focus Tree Issues
- **Prerequisites not working**: Verify focus IDs match exactly
- **Positioning problems**: Check x/y coordinates and relative_position_id
- **AI not taking focuses**: Review ai_will_do factors and available conditions

### Script Errors
- **Bracket mismatch**: Ensure all `{}` are properly opened and closed
- **Invalid triggers**: Verify trigger syntax against HOI4 documentation
- **Missing files**: Check file paths and names match exactly (case-sensitive)

### Performance Issues
- **Slow loading**: Optimize large scripted effects and reduce nested conditions
- **Memory usage**: Consider splitting large files into smaller modules
- **AI lag**: Review complex AI conditions and reduce unnecessary calculations

## Resources and References

- [HOI4 Modding Documentation](https://hoi4.paradoxwikis.com/Modding)
- [Paradox Script Reference](https://hoi4.paradoxwikis.com/Triggers)
- [Steam Workshop Page](https://steamcommunity.com/sharedfiles/filedetails/?id=2926389173)
- [Translation Project](https://paratranz.cn/projects/9454)
- [Developer Discord](https://discord.gg/nNYQGeePpR)
- [Community Discord](https://discord.com/invite/dykkFfVEp8)

Remember: This mod represents an alternative history scenario based on the "Foolish World Map" concept. Balance historical authenticity with creative gameplay while maintaining the spirit of community collaboration and satirical elements that make this project unique.